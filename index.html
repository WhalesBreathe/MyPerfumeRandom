<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>香水随机抽取器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            color: #8b6b61;
            font-size: 2.5rem;
            margin-bottom: 30px;
            font-weight: 300;
            letter-spacing: 2px;
        }
        
        .draw-btn {
            background: #e8b4bc;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 30px 0;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(232, 180, 188, 0.4);
        }
        
        .draw-btn:hover {
            background: #d9a3ab;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(232, 180, 188, 0.6);
        }

        /* 已移除添加按钮样式（非必需） */
        
        .result-section {
            display: none;
            margin: 40px 0;
            padding: 40px;
            background: linear-gradient(135deg, #fdf6f0 0%, #f8edeb 100%);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            animation: fadeIn 0.5s ease;
            /* 垂直水平居中内容 */
            display: none; /* 初始隐藏 */
            align-items: center;
            justify-content: center;
            text-align: center;
            flex-direction: column;
            gap: 10px;
        }
        
        .result-text {
            font-size: 1.8rem;
            color: #8b6b61;
            margin-bottom: 0;
            line-height: 1.5;
            text-align: center; /* 使段落文本水平居中 */
        }
        
        .perfume-name {
            font-weight: bold;
            color: #9c89b8;
            font-size: 2.2rem;
            display: inline-block;
            margin: 0 5px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
            animation: namePop 0.5s ease;
        }
        
        /* 已移除“再次抽取”按钮样式；使用单一“开始抽取”按钮重复抽取 */
        
        .loading {
            display: none;
            margin: 20px 0;
        }
        
        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #9c89b8;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        /* 模态弹窗 */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.45);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: #fff;
            padding: 20px 18px;
            border-radius: 12px;
            min-width: 300px;
            max-width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
            text-align: left;
        }

        .modal-content h3 {
            margin-bottom: 10px;
            color: #8b6b61;
            font-weight: 500;
        }

        .modal-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        /* 表单与提示相关样式已移除 */
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes namePop {
            0% { transform: scale(0.8); opacity: 0; }
            70% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .instructions {
            margin-top: 20px;
            color: #777;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .footer {
            margin-top: 30px;
            color: #999;
            font-size: 0.8rem;
        }

        /* 页面底部更新提示样式 */
        .update-note {
            text-align: center;
            color: #9aa3a8; /* 浅灰，和页面色调协调 */
            font-size: 0.95rem;
            margin: 26px 0 6px 0;
            padding: 8px 12px;
            width: 100%;
        }
        
        .perfume-count {
            margin-top: 10px;
            color: #9c89b8;
            font-weight: bold;
        }
        /* 左上角管理按钮 */
        .manage-btn {
            position: fixed;
            left: 18px;
            top: 18px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            /* 浅色纯色背景，去掉明显图案与强阴影 */
            background: #f6efe9; /* 浅米色/暖色调 */
            color: #8b6b61; /* 与页面主色协调的暗色文字 */
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: none;
            cursor: pointer;
            z-index: 1500;
            border: 1px solid rgba(0,0,0,0.04);
        }

        .manage-btn:hover::after {
            content: '点击查看香水库';
            position: absolute;
            left: 60px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.75);
            color: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            white-space: nowrap;
        }

    /* 当作为仅文字按钮时去掉多余文字宽度 */
    #viewBtn { padding: 0; width:44px; height:44px; font-size:16px; line-height:1; }

        /* 管理面板 */
        /* 管理面板样式已移除（页面为只读查看） */
    </style>
</head>
<body>
    <!-- 左上角查看按钮（平常只显示图标，悬停提示） -->
        <button id="viewBtn" class="manage-btn" title="查看香水库">库</button>
    <div class="container">
        <h1>今天用什么香水</h1>
        
        <p class="perfume-count">香水库中有 <span id="perfumeCount">0</span> 款香水</p>
        
        <button id="drawBtn" class="draw-btn">开始抽取</button>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>正在抽取中...</p>
        </div>
        
        <div class="result-section" id="resultSection">
            <div class="result-text"> <span class="perfume-name" id="perfumeName">未知香水</span> </div>
        </div>
        
        <!-- 添加香水功能已移除 -->
    </div>
    
    <!-- 只读查看香水库模态（居中） -->
    <div class="modal" id="viewModal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" style="max-width:720px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                <h3 style="margin:0;color:#8b6b61;">香水库</h3>
                <button id="closeView" aria-label="关闭" style="background:transparent;border:none;font-size:1.4rem;cursor:pointer;">✕</button>
            </div>
            <div id="viewList" style="max-height:60vh;overflow:auto;padding-right:6px;">
                <!-- 列表由 JS 渲染 -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const drawBtn = document.getElementById('drawBtn');
            const loading = document.getElementById('loading');
            const resultSection = document.getElementById('resultSection');
            const perfumeName = document.getElementById('perfumeName');
            // 已移除单独的“再次抽取”按钮，使用同一个开始按钮重复抽取
            const perfumeCount = document.getElementById('perfumeCount');
            
            // 首选从同目录下的 perfume&brand.json 加载；若加载失败则使用内嵌备份数据
            let perfumes = [];

                        // 内嵌备份（来自 perfume&brand.json）
                        const embeddedData = [
    {
        "brand": "莱俪",
        "perfume": "墨恋"
    },
    {
        "brand": "奥利弗",
        "perfume": "So Pure如纯男士"
    },
    {
        "brand": "祖马珑",
        "perfume": "鼠尾草与海盐"
    },
    {
        "brand": "橘滋",
        "perfume": "脏话"
    },
    {
        "brand": "阿蒂仙",
        "perfume": "布列塔尼的空气"
    },
    {
        "brand": "莫杰",
        "perfume": "雏菊花语"
    },
    {
        "brand": "梅森马吉拉",
        "perfume": "温暖壁炉 By the Fireplace"
    },
    {
        "brand": "梅森马吉拉",
        "perfume": "爵士酒廊 Jazz Club"
    },
    {
        "brand": "阿玛尼",
        "perfume": "寄情男士"
    },
    {
        "brand": "解放橘郡",
        "perfume": "你或像你的人"
    },
    {
        "brand": "解放橘郡",
        "perfume": "我是垃圾"
    },
    {
        "brand": "解放橘郡",
        "perfume": "圣婴"
    },
    {
        "brand": "解放橘郡",
        "perfume": "龙与玫瑰"
    },
    {
        "brand": "解放橘郡",
        "perfume": "赫曼如影"
    },
    {
        "brand": "祖马珑",
        "perfume": "葡萄藤与柏木"
    },
    {
        "brand": "解放橘郡",
        "perfume": "攻壳机动队"
    },
    {
        "brand": "爱马仕",
        "perfume": "大地香精"
    },
    {
        "brand": "爱马仕",
        "perfume": "大地淡香水"
    },
    {
        "brand": "万宝龙",
        "perfume": "探寻旅者"
    },
    {
        "brand": "博柏利",
        "perfume": "伦敦男士"
    },
    {
        "brand": "配枪朱丽叶",
        "perfume": "非香水"
    },
    {
        "brand": "配枪朱丽叶",
        "perfume": "莫斯科之骡"
    },
    {
        "brand": "艾克卡帕",
        "perfume": "白苔"
    },
    {
        "brand": "解放橘郡",
        "perfume": "一无所有"
    },
    {
        "brand": "米勒博涛斯",
        "perfume": "双重薄荷"
    },
    {
        "brand": "莫若森",
        "perfume": "柑橘之书"
    },
    {
        "brand": "纳西索",
        "perfume": "纯粹迷情（精纯麝香）"
    },
    {
        "brand": "潘海利根",
        "perfume": "月亮女神"
    },
    {
        "brand": "SMN",
        "perfume": "佛罗伦萨天使"
    },
    {
        "brand": "SMN",
        "perfume": "扑扑莉"
    },
    {
        "brand": "SMN",
        "perfume": "托斯卡诺烟草"
    },
    {
        "brand": "液态创想",
        "perfume": "粉色之彼（醉玫瑰）"
    },
    {
        "brand": "蒂普提克",
        "perfume": "谭道"
    },
    {
        "brand": "芦丹氏",
        "perfume": "修女"
    },
    {
        "brand": "潘海利根",
        "perfume": "裁缝"
    },
    {
        "brand": "詹姆斯·海利",
        "perfume": "鲜薄荷"
    },
    {
        "brand": "阿蒂仙",
        "perfume": "冥府之路馥郁版"
    },
    {
        "brand": "梅森马吉拉",
        "perfume": "慵懒周末"
    },
    {
        "brand": "梵克雅宝",
        "perfume": "月光广霍"
    },
    {
        "brand": "SMN",
        "perfume": "石榴"
    },
    {
        "brand": "解放橘郡",
        "perfume": "茉莉与雪茄"
    },
    {
        "brand": "解放橘郡",
        "perfume": "牧神的午后"
    },
    {
        "brand": "解放橘郡",
        "perfume": "同名古龙"
    },
    {
        "brand": "配枪朱丽叶",
        "perfume": "隐衫之欲"
    },
    {
        "brand": "爱马仕",
        "perfume": "血色大黄"
    },
    {
        "brand": "帝国之香",
        "perfume": "光之呐喊"
    },
    {
        "brand": "爱慕",
        "perfume": "回忆录男士"
    },
    {
        "brand": "爱慕",
        "perfume": "史诗女士"
    },
    {
        "brand": "爱慕",
        "perfume": "玫瑰焚香"
    },
    {
        "brand": "蒂普提克",
        "perfume": "水中影"
    },
    {
        "brand": "蒂普提克",
        "perfume": "纸上"
    },
    {
        "brand": "阿蒂仙",
        "perfume": "淘气野狼"
    },
    {
        "brand": "莱俪",
        "perfume": "珍珠美人"
    },
    {
        "brand": "古特尔",
        "perfume": "忍冬"
    },
    {
        "brand": "娇兰",
        "perfume": "一千零一夜"
    },
    {
        "brand": "爱慕",
        "perfume": "间奏曲男士"
    },
    {
        "brand": "爱慕",
        "perfume": "秘藏神谕"
    },
    {
        "brand": "馥马尔香水出版社",
        "perfume": "窈窕如她（贵妇肖像）"
    },
    {
        "brand": "蒂普提克",
        "perfume": "杜耶尔EDT"
    },
    {
        "brand": "蒂普提克",
        "perfume": "奥费恩（爵梦）EDP"
    },
    {
        "brand": "芦丹氏",
        "perfume": "母狼"
    },
    {
        "brand": "娇兰",
        "perfume": "香草甜酒"
    },
    {
        "brand": "宾利",
        "perfume": "黑色尊爵"
    },
    {
        "brand": "弗拉潘",
        "perfume": "永不复返"
    },
    {
        "brand": "芦丹氏",
        "perfume": "玻璃纸之夜（八月夜桂）"
    },
    {
        "brand": "徕汀",
        "perfume": "霍斯卡蓝"
    },
    {
        "brand": "潘海利根",
        "perfume": "牧羊少年EDP"
    },
    {
        "brand": "潘海利根",
        "perfume": "琴酒（杜松司令）EDT"
    },
    {
        "brand": "SMN",
        "perfume": "鸢尾"
    },
    {
        "brand": "梵诗柯香MFK",
        "perfume": "晶红540香精"
    },
    {
        "brand": "弗拉潘",
        "perfume": "炽木"
    },
    {
        "brand": "蒂普提克",
        "perfume": "杜桑晚香玉EDP"
    },
    {
        "brand": "俾你乜",
        "perfume": "是但求其"
    },
    {
        "brand": "俾你乜",
        "perfume": "落班之后"
    },
    {
        "brand": "娇兰",
        "perfume": "柑橘罗勒"
    },
    {
        "brand": "TDC",
        "perfume": "白扎戈拉"
    },
    {
        "brand": "蒂普提克",
        "perfume": "无花果EDT"
    },
    {
        "brand": "蒙大拿",
        "perfume": "红宝石3号"
    },
    {
        "brand": "蔻依",
        "perfume": "木兰诗语"
    },
    {
        "brand": "ALTERNATIVE LAB",
        "perfume": "黑色花谷"
    },
    {
        "brand": "阿曼奢华",
        "perfume": "Mariya"
    },
    {
        "brand": "阿曼奢华",
        "perfume": "Wanderlust"
    },
    {
        "brand": "阿曼奢华",
        "perfume": "Oud Aquilaria"
    },
    {
        "brand": "阿曼奢华",
        "perfume": "Overdose"
    },
    {
        "brand": "蝴蝶工匠",
        "perfume": "树妖Dryad"
    },
    {
        "brand": "蝴蝶工匠",
        "perfume": "阿努比斯Anubis"
    },
    {
        "brand": "蝴蝶工匠",
        "perfume": "烟草玫瑰Tobacco Rose"
    },
    {
        "brand": "门蒂托洛萨",
        "perfume": "天狼星Sirio"
    },
    {
        "brand": "门蒂托洛萨",
        "perfume": "人才"
    },
    {
        "brand": "门蒂托洛萨",
        "perfume": "愚人"
    },
    {
        "brand": "tf",
        "perfume": "黑之黑"
    },
    {
        "brand": "爱慕",
        "perfume": "化蝶女"
    },
    {
        "brand": "爱慕",
        "perfume": "迪亚女"
    },
    {
        "brand": "lelabo",
        "perfume": "檀木33"
    },
    {
        "brand": "芦丹氏",
        "perfume": "乳牙"
    },
    {
        "brand": "杰弗里",
        "perfume": "灰色法兰绒"
    },
    {
        "brand": "蒂普提克",
        "perfume": "漩涡edp"
    },
    {
        "brand": "帕尔马之水",
        "perfume": "桃金娘加州桂"
    },
    {
        "brand": "柏氛",
        "perfume": "602胡椒、雪松与广藿香"
    },
    {
        "brand": "面具",
        "perfume": "等待"
    },
    {
        "brand": "面具",
        "perfume": "爱情杀戮"
    },
    {
        "brand": "米欧法修尼",
        "perfume": "小歌"
    },
    {
        "brand": "米欧法修尼",
        "perfume": "#2旅行笔记：谢谢"
    },
    {
        "brand": "艾利斯布鲁克林",
        "perfume": "神话"
    },
    {
        "brand": "SMN",
        "perfume": "小苍兰"
    },
    {
        "brand": "馥马尔香水出版社",
        "perfume": "法国情人"
    },
    {
        "brand": "奥比维斯",
        "perfume": "抹茶"
    },
    {
        "brand": "卡朗",
        "perfume": "白色烟草"
    },
    {
        "brand": "梅森马吉拉",
        "perfume": "鲜花市场"
    },
    {
        "brand": "凯利安",
        "perfume": "天使之享微醺版"
    },
    {
        "brand": "纳西索",
        "perfume": "黑瓶For Her她的同名女士淡香水"
    },
    {
        "brand": "纳西索",
        "perfume": "柔雾迷情"
    },
    {
        "brand": "萨那花园",
        "perfume": "金发柏柏尔人"
    },
    {
        "brand": "古特尔",
        "perfume": "火焰乳香"
    },
    {
        "brand": "娇兰",
        "perfume": "土耳其玫瑰"
    },
    {
        "brand": "馥马尔香水出版社",
        "perfume": "狂野麝香"
    },
    {
        "brand": "馥马尔香水出版社",
        "perfume": "不羁香根草"
    },
    {
        "brand": "香奈儿",
        "perfume": "巴黎-巴黎"
    },
    {
        "brand": "尼可莱",
        "perfume": "紫罗兰的爱"
    },
    {
        "brand": "银杉",
        "perfume": "鸢尾丛"
    },
    {
        "brand": "浪凡",
        "perfume": "琶音"
    },
    {
        "brand": "尼可莱",
        "perfume": "纽约"
    },
    {
        "brand": "雅克罗",
        "perfume": "幻雾"
    },
    {
        "brand": "尼可莱",
        "perfume": "宫娥"
    },
    {
        "brand": "米勒海莉诗",
        "perfume": "秘密花园"
    },
    {
        "brand": "配枪朱丽叶",
        "perfume": "复仇女神"
    },
    {
        "brand": "SMN",
        "perfume": "玫瑰"
    },
    {
        "brand": "潘海利根",
        "perfume": "狐狸"
    },
    {
        "brand": "门蒂托洛萨",
        "perfume": "北方"
    },
    {
        "brand": "门蒂托洛萨",
        "perfume": "圣意"
    },
    {
        "brand": "杜加尔",
        "perfume": "密西西比医学"
    },
    {
        "brand": "杜加尔",
        "perfume": "德巴瑟"
    },
    {
        "brand": "尼古莱",
        "perfume": "沙漠驿站"
    },
    {
        "brand": "威尼斯商人",
        "perfume": "安达卢西亚之魂"
    },
    {
        "brand": "爱慕",
        "perfume": "黄金女"
    },
    {
        "brand": "爱慕",
        "perfume": "蜿蜒"
    },
    {
        "brand": "翡冷翠之香",
        "perfume": "黑郁金香"
    },
    {
        "brand": "弗拉潘",
        "perfume": "1270"
    },
    {
        "brand": "杰奎斯菲斯",
        "perfume": "失乐园"
    },
    {
        "brand": "卡普里岛",
        "perfume": "特拉米亚"
    },
    {
        "brand": "臆想作家",
        "perfume": "燃烧的城市"
    },
    {
        "brand": "YSL",
        "perfume": "红丝绒"
    },
    {
        "brand": "阿蒂仙",
        "perfume": "小偷玫瑰"
    },
    {
        "brand": "柔山",
        "perfume": "白与白芷"
    },
    {
        "brand": "柔山",
        "perfume": "亿万富翁"
    },
    {
        "brand": "爱绰",
        "perfume": "虚幻宫殿"
    },
    {
        "brand": "阿特金森",
        "perfume": "梅菲尔的金色舞会"
    },
    {
        "brand": "爱马仕",
        "perfume": "尼罗河花园"
    },
    {
        "brand": "阿特金森",
        "perfume": "玫瑰梦境"
    },
    {
        "brand": "阿特金森",
        "perfume": "阿特金森 无根之水"
    },
    {
        "brand": "阿特金森",
        "perfume": "挚爱捧花语"
    },
    {
        "brand": "尼古莱",
        "perfume": "粉缎麝香精粹"
    },
    {
        "brand": "YSL",
        "perfume": "缪斯（灵感之墨）"
    },
    {
        "brand": "MEMO",
        "perfume": "茵莱茶桂"
    },
    {
        "brand": "夜游人",
        "perfume": "米斯法花园"
    },
    {
        "brand": "夜游人",
        "perfume": "记忆号汽车旅馆"
    },
    {
        "brand": "MEMO",
        "perfume": "法兰西诗人"
    },
    {
        "brand": "MEMO",
        "perfume": "玛法"
    },
    {
        "brand": "MEMO",
        "perfume": "拉利贝拉"
    },
    {
        "brand": "MEMO",
        "perfume": "爱尔兰旅行者"
    },
    {
        "brand": "MEMO",
        "perfume": "伊比利亚皮革"
    },
    {
        "brand": "MEMO",
        "perfume": "草原冒险家"
    },
    {
        "brand":"香水工坊",
        "perfume":"茶玫瑰"
    },
    {
        "brand":"爱慕",
        "perfume":"玫瑰魅语男士"
    },
    {
        "brand":"爱慕",
        "perfume":"图书馆收藏12-玫瑰焚香"
    },
    {
        "brand":"梵诗柯香MFK",
        "perfume":"巴黎夜色"
    },
    {
        "brand":"纳斯马图",
        "perfume":"苦艾"
    },
    {
        "brand":"潘海利根",
        "perfume":"沐浴香蒸"
    },
    {
        "brand":"雅克罗香",
        "perfume":"咖啡觉醒"
    },
    {
        "brand":"芦丹氏",
        "perfume":"香子兰木"
    },
    {
        "brand":"弗拉潘",
        "perfume":"地下酒吧"
    },
    {
        "brand":"克霖",
        "perfume":"冷棉"
    },
    {
        "brand":"徕汀",
        "perfume":"沉默巨著"
    },
    {
        "brand":"祖氏挚爱",
        "perfume":"42号花店"
    },
    {
        "brand":"帕尔马之水",
        "perfume":"西西里岛杏仁"
    }
];

            // 尝试从同目录下的 perfume&brand.json 加载数据，若失败则使用 embeddedData
            function loadPerfumes() {
                // 在数据加载完成前禁用抽取按钮
                drawBtn.disabled = true;

                return fetch('perfume&brand.json')
                    .then(resp => {
                        if (!resp.ok) throw new Error('网络响应非 OK');
                        return resp.json();
                    })
                    .then(data => {
                        // 期望数据为 [{brand, perfume}, ...]
                        perfumes = data.map(item => ({ brand: item.brand || '', perfume: item.perfume || item.perfume || '' }));
                    })
                    .catch(() => {
                        // 回退到内嵌数据
                        perfumes = embeddedData.slice();
                    })
                    .finally(() => {
                        // 更新计数并启用按钮
                        perfumeCount.textContent = perfumes.length;
                        drawBtn.disabled = false;
                        renderViewList();
                    });
            }

            // 格式化品牌与香水名的显示：去掉括号，统一使用空格分隔（不使用“的”）
            function formatBrandPerfume(brand, perf) {
                brand = (brand || '').toString().trim();
                perf = (perf || '').toString().trim();
                if (!brand) return perf;

                // 统一空格分隔，避免重复空格
                return `${brand} ${perf}`.replace(/\s+/g, ' ').trim();
            }

            // 开始：加载数据
            loadPerfumes();

            // 抽取逻辑：显示格式为 （品牌） + （香水名）
            drawBtn.addEventListener('click', function() {
                if (!perfumes || perfumes.length === 0) return;

                // 隐藏结果，显示加载动画
                resultSection.style.display = 'none';
                loading.style.display = 'block';
                drawBtn.disabled = true; // 在加载时禁用按钮，防止重复点击

                // 模拟抽取过程（添加一点延迟增强体验）
                setTimeout(function() {
                    // 随机选择一款香水
                    const randomIndex = Math.floor(Math.random() * perfumes.length);
                    const selected = perfumes[randomIndex];
                    // 使用新的格式化规则生成显示文本（不包含括号）
                    perfumeName.textContent = formatBrandPerfume(selected.brand, selected.perfume);

                    // 隐藏加载动画，显示结果（使用 flex 居中），重新启用按钮
                    loading.style.display = 'none';
                    resultSection.style.display = 'flex';
                    drawBtn.disabled = false;
                }, 200);
            });
            // ——— 查看香水库 模态逻辑 ———
            const viewBtn = document.getElementById('viewBtn');
            const viewModal = document.getElementById('viewModal');
            const viewList = document.getElementById('viewList');
            const closeView = document.getElementById('closeView');

            function renderViewList() {
                viewList.innerHTML = '';
                if (!perfumes || !perfumes.length) {
                    viewList.innerHTML = '<p style="color:#777">当前香水库为空。</p>';
                    return;
                }
                const ul = document.createElement('ul');
                ul.style.listStyle = 'none';
                ul.style.padding = '0';
                ul.style.margin = '0';
                ul.style.display = 'block';
                ul.style.rowGap = '8px';

                perfumes.forEach((p, idx) => {
                    const li = document.createElement('li');
                    li.style.padding = '10px 12px';
                    li.style.borderRadius = '8px';
                    li.style.background = '#faf7ff';
                    li.style.color = '#444';
                    li.style.boxShadow = 'inset 0 0 0 1px rgba(0,0,0,0.03)';
                    li.style.marginBottom = '8px';
                    li.style.display = 'flex';
                    li.style.alignItems = 'center';

                    const num = document.createElement('span');
                    num.textContent = (idx + 1) + '.';
                    num.style.display = 'inline-block';
                    num.style.width = '36px';
                    num.style.marginRight = '8px';
                    num.style.color = '#8b6b61';
                    num.style.fontWeight = '600';

                    const txt = document.createElement('span');
                    // 兼容两种数据格式：{brand, perfume} 或 老的 {name}
                    if (p.brand || p.perfume) {
                        const brand = p.brand || '';
                        const perf = p.perfume || '';
                        txt.textContent = brand ? formatBrandPerfume(brand, perf) : perf;
                    } else if (p.name) {
                        txt.textContent = p.name;
                    } else {
                        txt.textContent = '';
                    }

                    li.appendChild(num);
                    li.appendChild(txt);
                    ul.appendChild(li);
                });
                viewList.appendChild(ul);
            }

            function openView() {
                renderViewList();
                viewModal.style.display = 'flex';
                viewModal.setAttribute('aria-hidden', 'false');
            }

            function closeViewModal() {
                viewModal.style.display = 'none';
                viewModal.setAttribute('aria-hidden', 'true');
            }

            viewBtn.addEventListener('mouseenter', function() {
                // hover 提示由 CSS ::after 实现（已有 title 供无 CSS 环境使用）
            });

            viewBtn.addEventListener('click', function() {
                openView();
            });

            closeView.addEventListener('click', closeViewModal);

            // 点击遮罩（在 modal 外部）关闭
            viewModal.addEventListener('click', function(e) {
                if (e.target === viewModal) closeViewModal();
            });

            // ESC 关闭
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && viewModal.style.display === 'flex') {
                    closeViewModal();
                }
            });
        });
    </script>
    <div class="update-note">---香水库最新更新于2025.10.28---</div>
</body>
</html>